{
  "process_injection": {
    "description": "Functions used to inject code into remote processes",
    "mitre_technique": "T1055",
    "functions": [
      "VirtualAllocEx",
      "WriteProcessMemory",
      "ReadProcessMemory",
      "CreateRemoteThread",
      "CreateRemoteThreadEx",
      "NtCreateThreadEx",
      "RtlCreateUserThread",
      "QueueUserAPC",
      "NtQueueApcThread",
      "NtQueueApcThreadEx",
      "NtMapViewOfSection",
      "NtUnmapViewOfSection",
      "ZwMapViewOfSection",
      "ZwUnmapViewOfSection",
      "SetThreadContext",
      "GetThreadContext",
      "NtSetContextThread",
      "NtGetContextThread",
      "ResumeThread",
      "SuspendThread",
      "NtSuspendThread",
      "NtResumeThread",
      "NtAllocateVirtualMemory",
      "NtWriteVirtualMemory",
      "NtReadVirtualMemory",
      "NtProtectVirtualMemory"
    ]
  },
  "process_hollowing": {
    "description": "Functions used in process hollowing technique",
    "mitre_technique": "T1055.012",
    "functions": [
      "CreateProcessA",
      "CreateProcessW",
      "NtUnmapViewOfSection",
      "ZwUnmapViewOfSection",
      "VirtualAllocEx",
      "WriteProcessMemory",
      "SetThreadContext",
      "NtSetContextThread",
      "ResumeThread",
      "NtResumeThread",
      "GetThreadContext",
      "NtGetContextThread",
      "Wow64SetThreadContext",
      "Wow64GetThreadContext"
    ]
  },
  "dll_injection": {
    "description": "Functions used for DLL injection and reflective loading",
    "mitre_technique": "T1055.001",
    "functions": [
      "LoadLibraryA",
      "LoadLibraryW",
      "LoadLibraryExA",
      "LoadLibraryExW",
      "GetProcAddress",
      "GetModuleHandleA",
      "GetModuleHandleW",
      "LdrLoadDll",
      "LdrGetProcedureAddress",
      "LdrGetProcedureAddressEx",
      "RtlInitUnicodeString",
      "CreateRemoteThread",
      "NtCreateThreadEx"
    ]
  },
  "memory_manipulation": {
    "description": "Functions for allocating, protecting, and modifying memory regions",
    "mitre_technique": "T1055",
    "functions": [
      "VirtualAlloc",
      "VirtualAllocEx",
      "VirtualFree",
      "VirtualFreeEx",
      "VirtualProtect",
      "VirtualProtectEx",
      "VirtualQuery",
      "VirtualQueryEx",
      "HeapCreate",
      "HeapAlloc",
      "RtlMoveMemory",
      "RtlCopyMemory",
      "RtlFillMemory",
      "RtlZeroMemory",
      "NtAllocateVirtualMemory",
      "NtFreeVirtualMemory",
      "NtProtectVirtualMemory",
      "NtWriteVirtualMemory",
      "NtReadVirtualMemory",
      "ZwAllocateVirtualMemory",
      "ZwProtectVirtualMemory",
      "FlushInstructionCache"
    ]
  },
  "credential_access": {
    "description": "Functions used to access credentials and authentication data",
    "mitre_technique": "T1003",
    "functions": [
      "CredEnumerateA",
      "CredEnumerateW",
      "CredReadA",
      "CredReadW",
      "CredWriteA",
      "CredWriteW",
      "LsaEnumerateLogonSessions",
      "LsaGetLogonSessionData",
      "LsaRegisterLogonProcess",
      "LsaCallAuthenticationPackage",
      "LsaLookupAuthenticationPackage",
      "LsaConnectUntrusted",
      "SamIConnect",
      "SamrQueryInformationUser",
      "SamIFree_SAMPR_USER_INFO_BUFFER",
      "LsaRetrievePrivateData",
      "LsaStorePrivateData",
      "LsaOpenPolicy",
      "LsaQueryInformationPolicy",
      "SystemFunction005",
      "SystemFunction040",
      "SystemFunction041",
      "CryptUnprotectData",
      "CryptProtectData"
    ]
  },
  "token_manipulation": {
    "description": "Functions for manipulating access tokens and impersonation",
    "mitre_technique": "T1134",
    "functions": [
      "OpenProcessToken",
      "OpenThreadToken",
      "AdjustTokenPrivileges",
      "AdjustTokenGroups",
      "DuplicateToken",
      "DuplicateTokenEx",
      "ImpersonateLoggedOnUser",
      "ImpersonateNamedPipeClient",
      "ImpersonateSelf",
      "SetThreadToken",
      "CreateProcessWithTokenW",
      "CreateProcessAsUserA",
      "CreateProcessAsUserW",
      "CreateProcessWithLogonW",
      "NtSetInformationToken",
      "NtDuplicateToken",
      "NtOpenProcessToken",
      "NtOpenProcessTokenEx",
      "NtAdjustPrivilegesToken",
      "LogonUserA",
      "LogonUserW",
      "LogonUserExA",
      "LogonUserExW",
      "LookupPrivilegeValueA",
      "LookupPrivilegeValueW"
    ]
  },
  "code_execution": {
    "description": "Functions for creating processes and executing code",
    "mitre_technique": "T1059",
    "functions": [
      "CreateProcessA",
      "CreateProcessW",
      "CreateProcessAsUserA",
      "CreateProcessAsUserW",
      "CreateProcessWithLogonW",
      "CreateProcessWithTokenW",
      "WinExec",
      "ShellExecuteA",
      "ShellExecuteW",
      "ShellExecuteExA",
      "ShellExecuteExW",
      "system",
      "_wsystem",
      "_popen",
      "_wpopen",
      "CreateThread",
      "CreateThreadEx",
      "NtCreateThread",
      "NtCreateThreadEx",
      "NtCreateProcess",
      "NtCreateProcessEx",
      "NtCreateUserProcess",
      "RtlCreateProcessParametersEx"
    ]
  },
  "defense_evasion": {
    "description": "Functions used to detect and evade debugging, sandboxing, and analysis",
    "mitre_technique": "T1622",
    "functions": [
      "IsDebuggerPresent",
      "CheckRemoteDebuggerPresent",
      "NtQueryInformationProcess",
      "NtSetInformationProcess",
      "NtSetInformationThread",
      "NtQuerySystemInformation",
      "NtClose",
      "OutputDebugStringA",
      "OutputDebugStringW",
      "GetTickCount",
      "GetTickCount64",
      "QueryPerformanceCounter",
      "QueryPerformanceFrequency",
      "NtQueryPerformanceCounter",
      "GetSystemTime",
      "Sleep",
      "SleepEx",
      "NtDelayExecution",
      "WaitForSingleObject",
      "NtYieldExecution",
      "SetUnhandledExceptionFilter",
      "AddVectoredExceptionHandler",
      "NtSetDebugFilterState",
      "DbgBreakPoint",
      "DbgUiRemoteBreakin"
    ]
  },
  "keylogging_input_capture": {
    "description": "Functions used for keylogging and input capture",
    "mitre_technique": "T1056.001",
    "functions": [
      "SetWindowsHookExA",
      "SetWindowsHookExW",
      "UnhookWindowsHookEx",
      "CallNextHookEx",
      "GetAsyncKeyState",
      "GetKeyState",
      "GetKeyboardState",
      "MapVirtualKeyA",
      "MapVirtualKeyW",
      "MapVirtualKeyExA",
      "MapVirtualKeyExW",
      "RegisterRawInputDevices",
      "GetRawInputData",
      "GetRawInputBuffer",
      "ToUnicode",
      "ToAscii",
      "GetForegroundWindow",
      "GetWindowTextA",
      "GetWindowTextW",
      "AttachThreadInput"
    ]
  },
  "screen_capture": {
    "description": "Functions used for screen capture and recording",
    "mitre_technique": "T1113",
    "functions": [
      "BitBlt",
      "StretchBlt",
      "GetDC",
      "GetWindowDC",
      "CreateCompatibleDC",
      "CreateCompatibleBitmap",
      "GetDIBits",
      "SetDIBits",
      "SelectObject",
      "DeleteDC",
      "DeleteObject",
      "PrintWindow",
      "CreateDIBSection"
    ]
  },
  "clipboard_access": {
    "description": "Functions for accessing clipboard data",
    "mitre_technique": "T1115",
    "functions": [
      "OpenClipboard",
      "GetClipboardData",
      "SetClipboardData",
      "EmptyClipboard",
      "CloseClipboard",
      "AddClipboardFormatListener",
      "RemoveClipboardFormatListener",
      "SetClipboardViewer",
      "GetClipboardFormatNameA",
      "GetClipboardFormatNameW",
      "EnumClipboardFormats",
      "IsClipboardFormatAvailable"
    ]
  },
  "network_communication": {
    "description": "Functions for HTTP/network communication (C2, data exfiltration)",
    "mitre_technique": "T1071",
    "functions": [
      "InternetOpenA",
      "InternetOpenW",
      "InternetOpenUrlA",
      "InternetOpenUrlW",
      "InternetConnectA",
      "InternetConnectW",
      "InternetReadFile",
      "InternetReadFileExA",
      "InternetWriteFile",
      "HttpOpenRequestA",
      "HttpOpenRequestW",
      "HttpSendRequestA",
      "HttpSendRequestW",
      "HttpSendRequestExA",
      "HttpSendRequestExW",
      "HttpQueryInfoA",
      "HttpQueryInfoW",
      "InternetSetOptionA",
      "InternetSetOptionW",
      "URLDownloadToFileA",
      "URLDownloadToFileW",
      "URLDownloadToCacheFileA",
      "URLDownloadToCacheFileW",
      "WinHttpOpen",
      "WinHttpConnect",
      "WinHttpOpenRequest",
      "WinHttpSendRequest",
      "WinHttpReceiveResponse",
      "WinHttpReadData",
      "WinHttpWriteData",
      "WinHttpSetOption",
      "WinHttpQueryHeaders",
      "WSAStartup",
      "socket",
      "connect",
      "send",
      "recv",
      "sendto",
      "recvfrom",
      "bind",
      "listen",
      "accept",
      "gethostbyname",
      "getaddrinfo",
      "DnsQuery_A",
      "DnsQuery_W"
    ]
  },
  "file_system": {
    "description": "Functions for file creation, modification, and deletion",
    "mitre_technique": "T1070.004",
    "functions": [
      "CreateFileA",
      "CreateFileW",
      "WriteFile",
      "ReadFile",
      "DeleteFileA",
      "DeleteFileW",
      "CopyFileA",
      "CopyFileW",
      "MoveFileA",
      "MoveFileW",
      "MoveFileExA",
      "MoveFileExW",
      "SetFileAttributesA",
      "SetFileAttributesW",
      "NtCreateFile",
      "NtWriteFile",
      "NtReadFile",
      "NtDeleteFile",
      "NtSetInformationFile",
      "CreateFileMapping",
      "CreateFileMappingA",
      "CreateFileMappingW",
      "MapViewOfFile",
      "MapViewOfFileEx",
      "NtCreateSection",
      "NtMapViewOfSection"
    ]
  },
  "registry_manipulation": {
    "description": "Functions for modifying the Windows registry (persistence, config changes)",
    "mitre_technique": "T1547.001",
    "functions": [
      "RegCreateKeyExA",
      "RegCreateKeyExW",
      "RegOpenKeyExA",
      "RegOpenKeyExW",
      "RegSetValueExA",
      "RegSetValueExW",
      "RegDeleteKeyA",
      "RegDeleteKeyW",
      "RegDeleteValueA",
      "RegDeleteValueW",
      "RegQueryValueExA",
      "RegQueryValueExW",
      "NtCreateKey",
      "NtOpenKey",
      "NtSetValueKey",
      "NtDeleteKey",
      "NtDeleteValueKey",
      "NtQueryValueKey",
      "NtEnumerateKey",
      "NtEnumerateValueKey",
      "RegEnumKeyExA",
      "RegEnumKeyExW",
      "RegEnumValueA",
      "RegEnumValueW"
    ]
  },
  "service_manipulation": {
    "description": "Functions for creating and modifying Windows services",
    "mitre_technique": "T1543.003",
    "functions": [
      "OpenSCManagerA",
      "OpenSCManagerW",
      "CreateServiceA",
      "CreateServiceW",
      "OpenServiceA",
      "OpenServiceW",
      "ChangeServiceConfigA",
      "ChangeServiceConfigW",
      "ChangeServiceConfig2A",
      "ChangeServiceConfig2W",
      "StartServiceA",
      "StartServiceW",
      "ControlService",
      "DeleteService",
      "QueryServiceStatusEx",
      "EnumServicesStatusExA",
      "EnumServicesStatusExW"
    ]
  },
  "crypto_operations": {
    "description": "Cryptographic functions used in ransomware and data encryption",
    "mitre_technique": "T1486",
    "functions": [
      "CryptAcquireContextA",
      "CryptAcquireContextW",
      "CryptEncrypt",
      "CryptDecrypt",
      "CryptGenKey",
      "CryptDeriveKey",
      "CryptImportKey",
      "CryptExportKey",
      "CryptGenRandom",
      "CryptHashData",
      "CryptCreateHash",
      "CryptDestroyKey",
      "CryptDestroyHash",
      "CryptReleaseContext",
      "BCryptOpenAlgorithmProvider",
      "BCryptCloseAlgorithmProvider",
      "BCryptEncrypt",
      "BCryptDecrypt",
      "BCryptGenerateKeyPair",
      "BCryptImportKey",
      "BCryptExportKey",
      "BCryptGenRandom",
      "BCryptSignHash",
      "BCryptVerifySignature",
      "NCryptEncrypt",
      "NCryptDecrypt",
      "NCryptOpenStorageProvider",
      "NCryptOpenKey"
    ]
  },
  "named_pipe_operations": {
    "description": "Named pipe functions used for IPC, lateral movement, and C2",
    "mitre_technique": "T1570",
    "functions": [
      "CreateNamedPipeA",
      "CreateNamedPipeW",
      "ConnectNamedPipe",
      "DisconnectNamedPipe",
      "WaitNamedPipeA",
      "WaitNamedPipeW",
      "TransactNamedPipe",
      "PeekNamedPipe",
      "CallNamedPipeA",
      "CallNamedPipeW",
      "ImpersonateNamedPipeClient"
    ]
  },
  "wmi_execution": {
    "description": "COM/WMI functions used for lateral movement and execution",
    "mitre_technique": "T1047",
    "functions": [
      "CoCreateInstance",
      "CoCreateInstanceEx",
      "CoInitializeEx",
      "CoInitializeSecurity",
      "CoGetClassObject",
      "CLSIDFromProgID",
      "CLSIDFromString"
    ]
  },
  "amsi_bypass": {
    "description": "Functions targeted by AMSI bypass techniques",
    "mitre_technique": "T1562.001",
    "functions": [
      "AmsiInitialize",
      "AmsiOpenSession",
      "AmsiScanBuffer",
      "AmsiScanString",
      "AmsiCloseSession",
      "AmsiUninitialize",
      "AmsiResultIsMalware"
    ]
  },
  "etw_tampering": {
    "description": "Functions used to tamper with Event Tracing for Windows",
    "mitre_technique": "T1562.006",
    "functions": [
      "EtwEventWrite",
      "EtwEventWriteFull",
      "EtwEventWriteTransfer",
      "NtTraceEvent",
      "NtTraceControl",
      "EtwEventRegister",
      "EtwEventUnregister",
      "EventWrite",
      "EventWriteEx",
      "EventRegister",
      "EventUnregister"
    ]
  },
  "direct_syscall": {
    "description": "Patterns indicating direct syscall usage to bypass hooks",
    "mitre_technique": "T1106",
    "functions": [
      "NtAllocateVirtualMemory",
      "NtWriteVirtualMemory",
      "NtCreateThreadEx",
      "NtProtectVirtualMemory",
      "NtCreateSection",
      "NtMapViewOfSection",
      "NtCreateProcess",
      "NtCreateProcessEx",
      "NtCreateUserProcess",
      "NtOpenProcess",
      "NtOpenThread",
      "NtSuspendThread",
      "NtResumeThread",
      "NtSetContextThread",
      "NtGetContextThread",
      "NtQueueApcThread",
      "NtQueueApcThreadEx",
      "NtCreateFile",
      "NtReadFile",
      "NtWriteFile",
      "NtClose",
      "NtQuerySystemInformation",
      "NtQueryInformationProcess",
      "NtQueryInformationThread",
      "NtSetInformationProcess",
      "NtSetInformationThread",
      "NtDuplicateObject",
      "NtQueryObject",
      "NtCreateKey",
      "NtOpenKey",
      "NtSetValueKey",
      "NtDeleteValueKey"
    ]
  }
}
